---
title: "Persstatistiek"
output: 
  html_document:
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    toc_depth: 4
params:
  data: NA
  jaar: NA
  kwartaal: NA
  berichten.verzender.table: NA
  berichten.verzender.barplot: NA
  berichten.tabel.maand: NA
  berichten.barplot.maand: NA
  berichten.type.table: NA
  berichten.type.barplot: NA
  return.platform.table: NA
  return.platform.barplot: NA
---

```{r "Load required packages", include = FALSE}
pkg <- installed.packages()[, "Package"]
to.load <- c("RColorBrewer", "knitr", "ggplot2", "readxl")
for (load in to.load) {
    if(!(load %in% pkg)) {
        install.packages(load, dependencies=TRUE)
    }
    library(load, character.only = TRUE )
}
```

# `r paste("Persstatistiek: ", paste("jaar", params$kwartaal, sep= " "), sep = " ")`

## 1 Persberichten
### 1.1 Persberichten per beleid
#### 1.1.1 Algemeen {.tabset .tabset-fade}
##### Barplot
```{r "Persberichten per beleid: algemeen - plot", echo = FALSE, align="center"}
# Create dataframe
df.bericht.beleid <- data.frame(table(params$data$Beleid))
colnames(df.bericht.beleid) <- c("Beleid","Persberichten")

# Specify color pallete
colors <- c(brewer.pal(8,"Pastel2"), brewer.pal(9, "Pastel1"))

# Create graph
ggplot(data=df.bericht.beleid, aes(x=Beleid, y=Persberichten, fill=Beleid)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten per Beleid") +
  geom_text(aes(label=Persberichten),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_manual(values=colors)
```

##### Tabel
```{r "Persberichten per beleid: algemeen - tabel", echo = FALSE}
kable(df.bericht.beleid, caption = "Persberichten per Beleid")
```

#### 1.1.2 Detail
```{r "Persberichten detail - vorbereiding", include = FALSE}
df.bericht.detail <- split(params$data, params$data$Beleid)

for (i in levels(params$data$Beleid)) ({
  df.bericht.detail[[i]] <- data.frame(table(df.bericht.detail[[i]]$"Detail beleid"))
  df.bericht.detail[[i]] <- cbind(Beleid = i, df.bericht.detail[[i]])
  colnames(df.bericht.detail[[i]]) <- c("Beleid", "Detail","Persberichten")
})
```

##### 1.1.2.1 Economie {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Economie: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$Economie, aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Economie") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Economie: tabel", echo = FALSE}
kable(df.bericht.detail$Economie, caption = "Persberichten: Economie")
```

##### 1.1.2.2 Gouverneur {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Gouverneur: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$Gouverneur, aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Gouverneur") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Gouverneur: tabel", echo = FALSE}
kable(df.bericht.detail$Gouverneur, caption = "Persberichten: Gouverneur")
```

##### 1.1.2.3 Leefmilieu {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Leefmilieu: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$Leefmilieu, aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Leefmilieu") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Leefmilieu: tabel", echo = FALSE}
kable(df.bericht.detail$Leefmilieu, caption = "Persberichten: Leefmilieu")
```

##### 1.1.2.4 Mobiliteit {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Mobiliteit: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$Mobiliteit, aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Mobiliteit") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Mobiliteit: tabel", echo = FALSE}
kable(df.bericht.detail$Mobiliteit, caption = "Persberichten: Mobiliteit")
```

##### 1.1.2.5 Onderwijs en Educatie {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Onderwijs en Educatie: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$"Onderwijs en Educatie", aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Onderwijs en Educatie") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Onderwijs en Educatie: tabel", echo = FALSE}
kable(df.bericht.detail$"Onderwije en Educatie", caption = "Persberichten: Onderwijs en Educatie")
```

##### 1.1.2.6 Provinciebestuur {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Provinciebestuur: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$Provinciebestuur, aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Provinciebestuur") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Provinciebestuur: tabel", echo = FALSE}
kable(df.bericht.detail$"Provinciebestuur", caption = "Persberichten: Provinciebestuur")
```

##### 1.1.2.7 Ruimte {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Ruimte: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$Ruimte, aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Ruimte") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Ruimte: tabel", echo = FALSE}
kable(df.bericht.detail$Ruimte, caption = "Persberichten: Ruimte")
```

##### 1.1.2.8 Vrije Tijd {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten Vrije Tijd: barplot", echo = FALSE}
  ggplot(data=df.bericht.detail$"Vrije Tijd", aes(x=Detail, y=Persberichten, fill=Detail)) +
    geom_bar(position = "dodge", stat='identity') +
    xlab("Detail") +
    ylab("Aantal") +
    ggtitle("Persberichten: Vrije Tijd") +
    geom_text(aes(label=Persberichten),
              position=position_dodge(0.9), vjust=0) +
    theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten Vrije Tijd: tabel", echo = FALSE}
kable(df.bericht.detail$"Vrije Tijd", caption = "Persberichten: Vrije Tijd")
```



### 1.2 Persberichten per verzender {.tabset .tabset-fade}
#### Tabel
```{r "Persberichten per verzender - Tabel", echo = FALSE}
kable(params$berichten.verzender.table, caption="Persberichten per verzender")
```

#### Barplot
```{r "Persberichten per verzender - Barplot", echo = FALSE}
params$berichten.verzender.barplot
```

### 1.3 Persberichten per maand
#### 1.3.1 Per maand {.tabset .tabset-fade}
##### Barplot
```{r "Persberichten per maand - barplot", echo = FALSE}
params$berichten.barplot.maand
```

##### Tabel
```{r "Persberichten per maand: tabel", echo = FALSE}
kable(params$berichten.tabel.maand, caption = "Persberichten per maand")
```

#### 1.3.2 Per beleidsdomein
```{r "Persberichten per maand per beleid - voorbereiding", include = FALSE}
df.bericht.maand.beleid <- data.frame(table(params$data$Beleid, params$data$Maand))
colnames(df.bericht.maand.beleid) <- c("Beleid", "Maand", "Freq")
df.bericht.maand.beleid$Maand <- factor(df.bericht.maand.beleid$Maand, levels = c("jan", "feb", "mrt", "apr", "mei", "jun", "jul", "aug", "sep", "okt", "nov", "dec"))
df.bericht.maand.beleid <- split(df.bericht.maand.beleid, df.bericht.maand.beleid$Beleid)
```

##### 1.1.2.1 Economie {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Economie: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$Economie, aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Economie") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Economie: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$Economie, caption = "Persberichten per maand: Economie")
```

##### 1.1.2.2 Gouverneur {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Gouverneur: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$Gouverneur, aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Gouverneur") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Gouverneur: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$Gouverneur, caption = "Persberichten per maand : Gouverneur")
```

##### 1.1.2.3 Leefmilieu {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Leefmilieu: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$Leefmilieu, aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Leefmilieu") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Leefmilieu: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$Leefmilieu, caption = "Persberichten per maand: Leefmilieu")
```

##### 1.1.2.4 Mobiliteit {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Mobiliteit: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$Mobiliteit, aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Mobiliteit") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Mobiliteit: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$Mobiliteit, caption = "Persberichten per maand: Mobiliteit")
```

##### 1.1.2.5 Onderwijs en Educatie {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Onderwijs en Educatie: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$"Onderwijs en Educatie", aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Onderwijs en Educatie") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Onderwijs en Educatie: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$"Onderwije en Educatie", caption = "Persberichten per maand: Onderwijs en Educatie")
```

##### 1.1.2.6 Provinciebestuur {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Provinciebestuur: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$Provinciebestuur, aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Provinciebestuur") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Provinciebestuur: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$"Provinciebestuur", caption = "Persberichten per maand: Provinciebestuur")
```

##### 1.1.2.7 Ruimte {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Ruimte: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$Ruimte, aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Ruimte") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Ruimte: tabel", echo = FALSE}
kable(df.bericht.maand.beleid$Ruimte, caption = "Persberichten: Ruimte")
```

##### 1.1.2.8 Vrije Tijd {.tabset .tabset-fade}
###### Barplot
```{r "Persberichten per maand - Vrije Tijd: barplot", echo = FALSE}
ggplot(data=df.bericht.maand.beleid$"Vrije Tijd", aes(x=Beleid, y=Freq, fill=Maand)) +
  geom_bar(position = "dodge", stat='identity') +
  xlab("Beleid") +
  ylab("Aantal") +
  ggtitle("Persberichten: Maand (totaal) - Vrije Tijd") +
  geom_text(aes(label=Freq),
            position=position_dodge(0.9), vjust=0) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(values=colors)
```

###### Tabel
```{r "Persberichten per maand - Vrije Tijd: tabel", echo = FALSE}
kable(df.bericht.detail$Ruimte, caption = "Persberichten per maand: Vrije tijd")
```


### 1.4 Type persberichten {.tabset .tabset-fade}
#### Tabel
```{r "Persberichten per type - Tabel", echo = FALSE}
kable(params$berichten.type.table, caption = "Persberichten per type")
```

#### Barplot
```{r "Persberichten per type - Barplot", echo = FALSE}
params$berichten.type.barplot
```


## 2 Persreturn
### 2.1 Persreturn per beleid
#### 2.1.1 Algemeen {.tabset .tabset-fade}
##### Barplot
```{r "Persreturn per beleid - algemeen: barplot", echo = FALSE}
# Create dataframe for barplot -------------------------------------
    return.beleid <- data.frame(table(params$data$Beleid,
                                      params$data$Persreturn))
# Rename columns ---------------------------------------------------
    colnames(return.beleid) <- c("Beleid", "Persreturn", "Freq")
    
# Create barplot ---------------------------------------------------
    colors <- brewer.pal(6,"Pastel1")
    ggplot(data=return.beleid, aes(x=Beleid, y=Freq, fill=Persreturn)) + 
        geom_bar(position = "dodge", stat='identity') +
        xlab("Beleid") +
        ylab("Aantal") +
        ggtitle("Persreturn per beleid:") +
        geom_text(aes(label=Freq), 
                  position=position_dodge(0.9), vjust=0) +
        theme_bw() +
        theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
        scale_fill_manual(values=colors[2:1])  
```

##### Tabel
```{r "Persreturn per beleid - algemeen: tabel", echo = FALSE}
kable(return.beleid, caption= "Persreturn per beleid")
```

#### 2.1.2 Detail

### 2.2 Persreturn per platform {.tabset .tabset-fade}
#### Barplot
```{r "Persreturn per platform - barplot", echo = FALSE}
params$return.platform.barplot
```

#### Tabel
```{r "Persreturn per platform - tabel", echo = FALSE}
kable(params$return.platform.table, caption = "Persreturn per platform")
```




